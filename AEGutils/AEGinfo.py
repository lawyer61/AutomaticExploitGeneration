#-*- coding:utf-8 -*-

'''
关于输入文件的信息获取，比如ELF信息(Elf info)、保护机制(checksec)等
'''

import idaapi
import idc
import platform
import os 

def AEG_GetBits():
	info = idaapi.get_inf_structure()
	if info.is_64bit():
		bits = 64
	elif info.is_32bit():
		bits = 32
	else:
		bits = 16
	return bits

def AEG_GetInputName():
	return idc.GetInputFile() 

def AEG_GetInputFilePath():
	return os.path.dirname(idc.GetInputFilePath())

INFO_BITS = AEG_GetBits()
INFO_INPUT_FILENAME = AEG_GetInputName()
INFO_INPUT_FILEPATH = AEG_GetInputFilePath()
INFO_SYSTEM = platform.system().lower()